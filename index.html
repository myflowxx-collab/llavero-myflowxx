<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myflowxx - Tu Número de la Suerte</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            overflow: hidden; /* Evita el desbordamiento y las barras de desplazamiento */
        }
        #three-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* Detrás del contenido */
        }
        .content-container {
            position: relative;
            z-index: 2; /* Delante del canvas */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            padding: 1rem;
            color: white;
        }
        .orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        .glowing-text {
            text-shadow: 0 0 5px #4ade80, 0 0 10px #4ade80, 0 0 20px #4ade80, 0 0 40px #4ade80;
        }
        .number-box {
            border: 4px solid #f87171;
            box-shadow: 0 0 10px #f87171, 0 0 20px #f87171, inset 0 0 10px #f87171;
            animation: pulse-red 2s infinite;
        }
        @keyframes pulse-red {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 10px #f87171, 0 0 20px #f87171, inset 0 0 10px #f87171;
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 20px #ef4444, 0 0 40px #ef4444, inset 0 0 20px #ef4444;
            }
        }
        /* Efecto de partículas de fondo */
        .particle {
            position: absolute;
            background: #4ade80;
            border-radius: 50%;
            opacity: 0;
            animation: rise 10s infinite linear;
        }
        @keyframes rise {
            0% {
                transform: translateY(0);
                opacity: 0.5;
            }
            100% {
                transform: translateY(-100vh);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="bg-gray-900">

    <div id="particle-container"></div>
    <canvas id="three-canvas"></canvas>

    <div class="content-container">
        <!-- Contenido principal -->
        <div class="bg-black bg-opacity-60 backdrop-blur-sm p-8 rounded-2xl max-w-2xl w-full">
            <h1 class="text-2xl md:text-3xl font-bold text-green-400 glowing-text orbitron tracking-wider">
                PUEDES GANAR EL PREMIO CON EL SIGUIENTE NÚMERO
            </h1>
            <p class="text-sm text-gray-300 mt-2 mb-6 orbitron">(SOLO PARA LOS QUE ESTÁN EN MESA)</p>

            <div id="number-display" class="number-box my-4 p-6 rounded-lg w-48 h-48 mx-auto flex items-center justify-center">
                <span id="lucky-number" class="text-7xl md:text-8xl font-black text-red-400 orbitron">...</span>
            </div>
            
            <div id="message-display" class="text-red-500 font-bold mt-4 h-6"></div>
        </div>

        <!-- Slogans en la parte inferior -->
        <footer class="absolute bottom-5 left-0 right-0 text-center text-gray-400 text-xs md:text-sm space-y-2">
            <p class="font-bold orbitron tracking-widest">created not for NPC´s</p>
            <p class="font-bold glowing-text text-green-300 orbitron tracking-widest">LA ROPA ES TU TICKET...</p>
        </footer>
    </div>

    <!-- Scripts para Three.js y lógica de la página -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/"
            }
        }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { FontLoader } from 'three/addons/loaders/FontLoader.js';
        import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';

        // --- Lógica del número aleatorio ---
        function getUniqueNumber() {
            const userNumberKey = 'myflowxx_userNumber';
            const usedNumbersKey = 'myflowxx_usedNumbers';
            const maxNumber = 20;

            const numberEl = document.getElementById('lucky-number');
            const messageEl = document.getElementById('message-display');

            let assignedNumber = localStorage.getItem(userNumberKey);

            if (assignedNumber) {
                numberEl.textContent = assignedNumber;
                return;
            }

            let usedNumbers = JSON.parse(localStorage.getItem(usedNumbersKey)) || [];

            if (usedNumbers.length >= maxNumber) {
                numberEl.textContent = "X";
                messageEl.textContent = "Todos los números han sido asignados.";
                return;
            }

            let newNumber;
            do {
                newNumber = Math.floor(Math.random() * maxNumber) + 1;
            } while (usedNumbers.includes(newNumber));

            usedNumbers.push(newNumber);
            localStorage.setItem(usedNumbersKey, JSON.stringify(usedNumbers));
            localStorage.setItem(userNumberKey, newNumber);

            numberEl.textContent = newNumber;
        }

        // --- Lógica de partículas ---
        function createParticles() {
            const container = document.getElementById('particle-container');
            const particleCount = 50;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const size = Math.random() * 5 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.bottom = `-${size}px`;
                particle.style.animationDelay = `${Math.random() * 10}s`;
                particle.style.animationDuration = `${Math.random() * 5 + 5}s`;
                container.appendChild(particle);
            }
        }

        // --- Lógica de Three.js para el texto 3D ---
        let scene, camera, renderer, textMesh;

        function initThreeJS() {
            const canvas = document.getElementById('three-canvas');
            
            // Escena
            scene = new THREE.Scene();
            
            // Cámara
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 10;

            // Renderer
            renderer = new THREE.WebGLRenderer({ canvas, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));


            // Luces
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);

            const pointLight = new THREE.PointLight(0x4ade80, 2, 100); // Luz verde
            pointLight.position.set(5, 5, 5);
            scene.add(pointLight);
            
            const pointLightRed = new THREE.PointLight(0xf87171, 2, 100); // Luz roja
            pointLightRed.position.set(-5, -5, 5);
            scene.add(pointLightRed);


            // Cargar fuente y crear texto
            const fontLoader = new FontLoader();
            fontLoader.load(
                'https://cdn.jsdelivr.net/npm/three@0.158.0/examples/fonts/helvetiker_bold.typeface.json',
                (font) => {
                    const textGeometry = new TextGeometry('myflowxx', {
                        font: font,
                        size: 1.5,
                        height: 0.4,
                        curveSegments: 12,
                        bevelEnabled: true,
                        bevelThickness: 0.03,
                        bevelSize: 0.02,
                        bevelOffset: 0,
                        bevelSegments: 5
                    });
                    
                    textGeometry.center(); // Centrar la geometría

                    const textMaterial = new THREE.MeshStandardMaterial({
                        color: 0xcccccc, // Un color base metálico
                        metalness: 0.7,
                        roughness: 0.2,
                    });
                    
                    textMesh = new THREE.Mesh(textGeometry, textMaterial);
                    scene.add(textMesh);
                }
            );

            // Iniciar animación
            animate();
        }

        // Bucle de animación
        function animate() {
            requestAnimationFrame(animate);

            if (textMesh) {
                textMesh.rotation.y += 0.005; // Rotación constante
                textMesh.rotation.x += 0.002;
            }

            renderer.render(scene, camera);
        }

        // Manejar redimensión de la ventana
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // --- Inicialización ---
        window.addEventListener('resize', onWindowResize, false);
        
        document.addEventListener('DOMContentLoaded', () => {
            getUniqueNumber();
            createParticles();
            initThreeJS();
        });

    </script>

</body>
</html>
